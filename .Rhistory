`Not Guilty` = sum(disp_FNG + `disp_Verdict-Not Guilty`),
`No Probable Cause` = sum(disp_FNPC)
`
# `Nolle Pros.` = sum(ifelse(),na.rm = T),
# `Charged` = sum(CasesCharged,na.rm = T),
# `Not Arraigned - SCA or SCI` = sum(CasesArraignSupreme,na.rm = T),
# `Arraigned` = sum(CasesArraigned,na.rm = T),
# `Disposed at Arr.` = sum(CasesDisposedArraignment,na.rm = T),
# `Survived Arr.` = sum(CasesSurvivingArraignment,na.rm = T),
# `Indicted` = sum(CasesIndicted,na.rm = T),
# `Pled Guilty or Convicted` = sum(CasesSentenced,na.rm = T),
# `Dismissed` = sum(CasesDismissed,na.rm = T),
# `ACD` = sum(CasesDismissedACD,na.rm = T),
# `Non-ACD` = sum(CasesDismissedNONACD,na.rm = T),
# `Outstanding Bench Warrant` = sum(CasesBWO, na.rm = T)
) %>%
t() %>%
as.data.frame() %>%
as_tibble() %>%
rownames_to_column(var = " ") %>%
set_names(.[1,-1] %>% unlist() %>% as.numeric() %>% as.character() %>% c(" ",.)) %>%
filter(` `!="arrest_year") %>%
mutate_at(vars(-1),as.numeric) %>%
mutate(Total = rowSums(.[,2:ncol(.)]))
# `Not Arraigned - SCA or SCI` = sum(CasesArraignSupreme,na.rm = T),
# `Arraigned` = sum(CasesArraigned,na.rm = T),
# `Disposed at Arr.` = sum(CasesDisposedArraignment,na.rm = T),
# `Survived Arr.` = sum(CasesSurvivingArraignment,na.rm = T),
# `Indicted` = sum(CasesIndicted,na.rm = T),
# `Pled Guilty or Convicted` = sum(CasesSentenced,na.rm = T),
# `Dismissed` = sum(CasesDismissed,na.rm = T),
# `ACD` = sum(CasesDismissedACD,na.rm = T),
# `Non-ACD` = sum(CasesDismissedNONACD,na.rm = T),
# `Outstanding Bench Warrant` = sum(CasesBWO, na.rm = T)
) %>%
t() %>%
as.data.frame() %>%
as_tibble() %>%
rownames_to_column(var = " ") %>%
set_names(.[1,-1] %>% unlist() %>% as.numeric() %>% as.character() %>% c(" ",.)) %>%
filter(` `!="arrest_year") %>%
mutate_at(vars(-1),as.numeric) %>%
mutate(Total = rowSums(.[,2:ncol(.)]))
screen <-   d %>%
group_by(arrest_year) %>%
summarise(`Commenced` = n_distinct(CASE_PARTICIPANT_ID),
`via Preliminary Hearing`=sum(`EVENT_Preliminary Hearing`),
`via Indictment` = sum(EVENT_Indictment),
`via Other` = sum(`EVENT_Direct Indictment`+`EVENT_Grand Jury`,na.rm = T),
`Cases Approved`=sum(PARTICIPANT_STATUS=="Approved"),
`Cases Not Approved`=sum(!PARTICIPANT_STATUS=="Approved"),
Disposed=sum(disposed.x),
`Nolle Prosecution` = sum(`disp_Nolle Prosecution`),
`Pled Guilty` = sum(`disp_Plea Of Guilty`+`
disp_Finding Guilty` + `disp_Verdict Guilty`),
`Not Guilty` = sum(disp_FNG + `disp_Verdict-Not Guilty`),
`No Probable Cause` = sum(disp_FNPC)
# `Nolle Pros.` = sum(ifelse(),na.rm = T),
# `Charged` = sum(CasesCharged,na.rm = T),
# `Not Arraigned - SCA or SCI` = sum(CasesArraignSupreme,na.rm = T),
# `Arraigned` = sum(CasesArraigned,na.rm = T),
# `Disposed at Arr.` = sum(CasesDisposedArraignment,na.rm = T),
# `Survived Arr.` = sum(CasesSurvivingArraignment,na.rm = T),
# `Indicted` = sum(CasesIndicted,na.rm = T),
# `Pled Guilty or Convicted` = sum(CasesSentenced,na.rm = T),
# `Dismissed` = sum(CasesDismissed,na.rm = T),
# `ACD` = sum(CasesDismissedACD,na.rm = T),
# `Non-ACD` = sum(CasesDismissedNONACD,na.rm = T),
# `Outstanding Bench Warrant` = sum(CasesBWO, na.rm = T)
) %>%
t() %>%
as.data.frame() %>%
as_tibble() %>%
rownames_to_column(var = " ") %>%
set_names(.[1,-1] %>% unlist() %>% as.numeric() %>% as.character() %>% c(" ",.)) %>%
filter(` `!="arrest_year") %>%
mutate_at(vars(-1),as.numeric) %>%
mutate(Total = rowSums(.[,2:ncol(.)]))
screen <-   d %>%
group_by(arrest_year) %>%
summarise(`Commenced` = n_distinct(CASE_PARTICIPANT_ID),
`via Preliminary Hearing`=sum(`EVENT_Preliminary Hearing`),
`via Indictment` = sum(EVENT_Indictment),
`via Other` = sum(`EVENT_Direct Indictment`+`EVENT_Grand Jury`,na.rm = T),
`Cases Approved`=sum(PARTICIPANT_STATUS=="Approved"),
`Cases Not Approved`=sum(!PARTICIPANT_STATUS=="Approved"),
Disposed=sum(disposed.x),
`Nolle Prosecution` = sum(`disp_Nolle Prosecution`),
`Pled Guilty` = sum(`disp_Plea Of Guilty`+
`disp_Finding Guilty` + `disp_Verdict Guilty`),
`Not Guilty` = sum(disp_FNG + `disp_Verdict-Not Guilty`),
`No Probable Cause` = sum(disp_FNPC)
# `Nolle Pros.` = sum(ifelse(),na.rm = T),
# `Charged` = sum(CasesCharged,na.rm = T),
# `Not Arraigned - SCA or SCI` = sum(CasesArraignSupreme,na.rm = T),
# `Arraigned` = sum(CasesArraigned,na.rm = T),
# `Disposed at Arr.` = sum(CasesDisposedArraignment,na.rm = T),
# `Survived Arr.` = sum(CasesSurvivingArraignment,na.rm = T),
# `Indicted` = sum(CasesIndicted,na.rm = T),
# `Pled Guilty or Convicted` = sum(CasesSentenced,na.rm = T),
# `Dismissed` = sum(CasesDismissed,na.rm = T),
# `ACD` = sum(CasesDismissedACD,na.rm = T),
# `Non-ACD` = sum(CasesDismissedNONACD,na.rm = T),
# `Outstanding Bench Warrant` = sum(CasesBWO, na.rm = T)
) %>%
t() %>%
as.data.frame() %>%
as_tibble() %>%
rownames_to_column(var = " ") %>%
set_names(.[1,-1] %>% unlist() %>% as.numeric() %>% as.character() %>% c(" ",.)) %>%
filter(` `!="arrest_year") %>%
mutate_at(vars(-1),as.numeric) %>%
mutate(Total = rowSums(.[,2:ncol(.)]))
screen
screen <-   d %>%
group_by(arrest_year) %>%
summarise(`Commenced` = n_distinct(CASE_PARTICIPANT_ID),
`via Preliminary Hearing`=sum(`EVENT_Preliminary Hearing`),
`via Indictment` = sum(EVENT_Indictment),
`via Other` = sum(`EVENT_Direct Indictment`+`EVENT_Grand Jury`,na.rm = T),
`Cases Approved`=sum(PARTICIPANT_STATUS=="Approved"),
`Cases Not Approved`=sum(!PARTICIPANT_STATUS=="Approved"),
Disposed=sum(disposed.x),
`Nolle Prosecution` = sum(`disp_Nolle Prosecution`),
`Pled Guilty` = sum(`disp_Plea Of Guilty`+
`disp_Finding Guilty` + `disp_Verdict Guilty`),
`Not Guilty` = sum(disp_FNG + `disp_Verdict-Not Guilty`),
`No Probable Cause` = sum(disp_FNPC)
# `Nolle Pros.` = sum(ifelse(),na.rm = T),
# `Charged` = sum(CasesCharged,na.rm = T),
# `Not Arraigned - SCA or SCI` = sum(CasesArraignSupreme,na.rm = T),
# `Arraigned` = sum(CasesArraigned,na.rm = T),
# `Disposed at Arr.` = sum(CasesDisposedArraignment,na.rm = T),
# `Survived Arr.` = sum(CasesSurvivingArraignment,na.rm = T),
# `Indicted` = sum(CasesIndicted,na.rm = T),
# `Pled Guilty or Convicted` = sum(CasesSentenced,na.rm = T),
# `Dismissed` = sum(CasesDismissed,na.rm = T),
# `ACD` = sum(CasesDismissedACD,na.rm = T),
# `Non-ACD` = sum(CasesDismissedNONACD,na.rm = T),
# `Outstanding Bench Warrant` = sum(CasesBWO, na.rm = T)
) %>%
t() %>%
as.data.frame() %>%
#as_tibble() %>%
rownames_to_column(var = " ") %>%
set_names(.[1,-1] %>% unlist() %>% as.numeric() %>% as.character() %>% c(" ",.)) %>%
filter(` `!="arrest_year") %>%
mutate_at(vars(-1),as.numeric) %>%
mutate(Total = rowSums(.[,2:ncol(.)]))
screen
d %>%
filter(disposed.x==1) %>%
group_by(arreset_year,dsp) %>%
summarise(Dispositions = n())
d %>%
filter(disposed.x==1) %>%
group_by(arrest_year,dsp) %>%
summarise(Dispositions = n())
d %>%
filter(disposed.x==1) %>%
group_by(arrest_year,disp) %>%
summarise(Dispositions = n())
d %>%
filter(disposed.x==1) %>%
group_by(arrest_year,disp) %>%
summarise(Dispositions = n()) %>%
spread(disp,Dispositions,fill = 0) %>%
ungroup()
Desc(d$disp)
d %>%
filter(disposed.x==1) %>%
group_by(arrest_year,disp) %>%
summarise(Dispositions = n()) %>%
spread(disp,Dispositions,fill = 0) %>%
ungroup() %>%
mutate(`Nolle Pros. (%)` = `Nolle Prosecution`/rowSums(.[,2:ncol(.)]),
`Plea (%)` = `Plea`/rowSums(.[,2:ncol(.)]),
`Verdict Guilty (%)` = `Verdict Guilty`/rowSums(.[,2:ncol(.)]),
`No P.C. (%)` = FNPC/rowSums(.[,2:ncol(.)]),
#`ACD/M Dismissal (%)` = `ACD/M Dismissal`/rowSums(.[,2:ncol(.)]),
#`30.30 Speedy (%)` = `30.30 Speedy`/rowSums(.[,2:ncol(.)]),
#`Evidence Dismissal (%)` = `Evidence Dismissal`/rowSums(.[,2:ncol(.)]),
#`Other Non ACD/M Dismissal (%)` = `Other Non ACD/M Dismissal`/rowSums(.[,2:ncol(.)]),
#`Acquitted (%)` = `Acquitted`/rowSums(.[,2:ncol(.)]),
#`Other (%)` = `Other`/rowSums(.[,2:ncol(.)]),
Disposed = rowSums(.[,2:ncol(.)]))
d %>%
filter(disposed.x==1) %>%
group_by(arrest_year,disp) %>%
summarise(Dispositions = n()) %>%
spread(disp,Dispositions,fill = 0) %>%
ungroup() %>%
mutate(`Nolle Pros. (%)` = `Nolle Prosecution`/rowSums(.[,2:ncol(.)]),
`Plea (%)` = `Plea Of Guilty`/rowSums(.[,2:ncol(.)]),
`Verdict Guilty (%)` = `Verdict Guilty`/rowSums(.[,2:ncol(.)]),
`No P.C. (%)` = FNPC/rowSums(.[,2:ncol(.)]),
#`ACD/M Dismissal (%)` = `ACD/M Dismissal`/rowSums(.[,2:ncol(.)]),
#`30.30 Speedy (%)` = `30.30 Speedy`/rowSums(.[,2:ncol(.)]),
#`Evidence Dismissal (%)` = `Evidence Dismissal`/rowSums(.[,2:ncol(.)]),
#`Other Non ACD/M Dismissal (%)` = `Other Non ACD/M Dismissal`/rowSums(.[,2:ncol(.)]),
#`Acquitted (%)` = `Acquitted`/rowSums(.[,2:ncol(.)]),
#`Other (%)` = `Other`/rowSums(.[,2:ncol(.)]),
Disposed = rowSums(.[,2:ncol(.)]))
d %>%
filter(disposed.x==1) %>%
group_by(arrest_year,disp) %>%
summarise(Dispositions = n()) %>%
spread(disp,Dispositions,fill = 0) %>%
ungroup() %>%
mutate(`Nolle Pros. (%)` = `Nolle Prosecution`/rowSums(.[,2:ncol(.)]),
`Plea (%)` = `Plea Of Guilty`/rowSums(.[,2:ncol(.)]),
`Verdict Guilty (%)` = `Verdict Guilty`/rowSums(.[,2:ncol(.)]),
`Verdict Not Guilty (%)` = `Verdict-Not Guilty`/rowSums(.[,2:ncol(.)]),
`No P.C. (%)` = FNPC/rowSums(.[,2:ncol(.)]),
#`ACD/M Dismissal (%)` = `ACD/M Dismissal`/rowSums(.[,2:ncol(.)]),
#`30.30 Speedy (%)` = `30.30 Speedy`/rowSums(.[,2:ncol(.)]),
#`Evidence Dismissal (%)` = `Evidence Dismissal`/rowSums(.[,2:ncol(.)]),
#`Other Non ACD/M Dismissal (%)` = `Other Non ACD/M Dismissal`/rowSums(.[,2:ncol(.)]),
#`Acquitted (%)` = `Acquitted`/rowSums(.[,2:ncol(.)]),
#`Other (%)` = `Other`/rowSums(.[,2:ncol(.)]),
Disposed = rowSums(.[,2:ncol(.)]))
d %>%
filter(disposed.x==1) %>%
group_by(arrest_year,disp) %>%
summarise(Dispositions = n()) %>%
spread(disp,Dispositions,fill = 0) %>%
ungroup() %>%
mutate(`Nolle Pros. (%)` = `Nolle Prosecution`/rowSums(.[,2:ncol(.)]),
`Plea (%)` = `Plea Of Guilty`/rowSums(.[,2:ncol(.)]),
`Verdict Guilty (%)` = `Verdict Guilty`/rowSums(.[,2:ncol(.)]),
`Verdict Not Guilty (%)` = `Verdict-Not Guilty`/rowSums(.[,2:ncol(.)]),
`No P.C. (%)` = FNPC/rowSums(.[,2:ncol(.)]),
#`ACD/M Dismissal (%)` = `ACD/M Dismissal`/rowSums(.[,2:ncol(.)]),
#`30.30 Speedy (%)` = `30.30 Speedy`/rowSums(.[,2:ncol(.)]),
#`Evidence Dismissal (%)` = `Evidence Dismissal`/rowSums(.[,2:ncol(.)]),
#`Other Non ACD/M Dismissal (%)` = `Other Non ACD/M Dismissal`/rowSums(.[,2:ncol(.)]),
#`Acquitted (%)` = `Acquitted`/rowSums(.[,2:ncol(.)]),
#`Other (%)` = `Other`/rowSums(.[,2:ncol(.)]),
Disposed = rowSums(.[,2:ncol(.)]))  %>%
select(arrest_year,
`Plea`,`Plea (%)`,
`Verdict Guilty`,`Verdict Guilty (%)`,
FNPC, `No P.C. (%)`)
d %>%
filter(disposed.x==1) %>%
group_by(arrest_year,disp) %>%
summarise(Dispositions = n()) %>%
spread(disp,Dispositions,fill = 0) %>%
ungroup() %>%
mutate(`Nolle Pros. (%)` = `Nolle Prosecution`/rowSums(.[,2:ncol(.)]),
`Plea (%)` = `Plea Of Guilty`/rowSums(.[,2:ncol(.)]),
`Verdict Guilty (%)` = `Verdict Guilty`/rowSums(.[,2:ncol(.)]),
`Verdict Not Guilty (%)` = `Verdict-Not Guilty`/rowSums(.[,2:ncol(.)]),
`No P.C. (%)` = FNPC/rowSums(.[,2:ncol(.)]),
#`ACD/M Dismissal (%)` = `ACD/M Dismissal`/rowSums(.[,2:ncol(.)]),
#`30.30 Speedy (%)` = `30.30 Speedy`/rowSums(.[,2:ncol(.)]),
#`Evidence Dismissal (%)` = `Evidence Dismissal`/rowSums(.[,2:ncol(.)]),
#`Other Non ACD/M Dismissal (%)` = `Other Non ACD/M Dismissal`/rowSums(.[,2:ncol(.)]),
#`Acquitted (%)` = `Acquitted`/rowSums(.[,2:ncol(.)]),
#`Other (%)` = `Other`/rowSums(.[,2:ncol(.)]),
Disposed = rowSums(.[,2:ncol(.)]))  %>%
select(arrest_year,
`Plea Of Guilty`,`Plea (%)`,
`Verdict Guilty`,`Verdict Guilty (%)`,
FNPC, `No P.C. (%)`)
d %>%
filter(disposed.x==1) %>%
group_by(arrest_year,disp) %>%
summarise(Dispositions = n()) %>%
spread(disp,Dispositions,fill = 0) %>%
ungroup() %>%
mutate(`Nolle Pros. (%)` = `Nolle Prosecution`/rowSums(.[,2:ncol(.)]),
`Plea (%)` = `Plea Of Guilty`/rowSums(.[,2:ncol(.)]),
`Verdict Guilty (%)` = `Verdict Guilty`/rowSums(.[,2:ncol(.)]),
`Verdict Not Guilty (%)` = `Verdict-Not Guilty`/rowSums(.[,2:ncol(.)]),
`No P.C. (%)` = FNPC/rowSums(.[,2:ncol(.)]),
#`ACD/M Dismissal (%)` = `ACD/M Dismissal`/rowSums(.[,2:ncol(.)]),
#`30.30 Speedy (%)` = `30.30 Speedy`/rowSums(.[,2:ncol(.)]),
#`Evidence Dismissal (%)` = `Evidence Dismissal`/rowSums(.[,2:ncol(.)]),
#`Other Non ACD/M Dismissal (%)` = `Other Non ACD/M Dismissal`/rowSums(.[,2:ncol(.)]),
#`Acquitted (%)` = `Acquitted`/rowSums(.[,2:ncol(.)]),
#`Other (%)` = `Other`/rowSums(.[,2:ncol(.)]),
Disposed = rowSums(.[,2:ncol(.)]))  %>%
select(arrest_year,
`Plea Of Guilty`,`Plea (%)`,
`Verdict Guilty`,`Verdict Guilty (%)`,
FNPC, `No P.C. (%)`,
`Verdict Not Guilty`,`Verdict Not Guilty (%)`,
Disposed)
d %>%
filter(disposed.x==1) %>%
group_by(arrest_year,disp) %>%
summarise(Dispositions = n()) %>%
spread(disp,Dispositions,fill = 0) %>%
ungroup() %>%
mutate(`Nolle Pros. (%)` = `Nolle Prosecution`/rowSums(.[,2:ncol(.)]),
`Plea (%)` = `Plea Of Guilty`/rowSums(.[,2:ncol(.)]),
`Verdict Guilty (%)` = `Verdict Guilty`/rowSums(.[,2:ncol(.)]),
`Verdict Not Guilty (%)` = `Verdict-Not Guilty`/rowSums(.[,2:ncol(.)]),
`No P.C. (%)` = FNPC/rowSums(.[,2:ncol(.)]),
#`ACD/M Dismissal (%)` = `ACD/M Dismissal`/rowSums(.[,2:ncol(.)]),
#`30.30 Speedy (%)` = `30.30 Speedy`/rowSums(.[,2:ncol(.)]),
#`Evidence Dismissal (%)` = `Evidence Dismissal`/rowSums(.[,2:ncol(.)]),
#`Other Non ACD/M Dismissal (%)` = `Other Non ACD/M Dismissal`/rowSums(.[,2:ncol(.)]),
#`Acquitted (%)` = `Acquitted`/rowSums(.[,2:ncol(.)]),
#`Other (%)` = `Other`/rowSums(.[,2:ncol(.)]),
Disposed = rowSums(.[,2:ncol(.)]))  %>%
select(arrest_year,
`Plea Of Guilty`,`Plea (%)`,
`Verdict Guilty`,`Verdict Guilty (%)`,
FNPC, `No P.C. (%)`,
`Verdict-Not Guilty`,`Verdict Not Guilty (%)`,
Disposed)
d %>%
filter(disposed.x==1) %>%
group_by(arrest_year,disp) %>%
summarise(Dispositions = n()) %>%
spread(disp,Dispositions,fill = 0) %>%
ungroup() %>%
mutate(`Nolle Pros. (%)` = `Nolle Prosecution`/rowSums(.[,2:ncol(.)]),
`Plea (%)` = `Plea Of Guilty`/rowSums(.[,2:ncol(.)]),
`Verdict Guilty (%)` = `Verdict Guilty`/rowSums(.[,2:ncol(.)]),
`Verdict Not Guilty (%)` = `Verdict-Not Guilty`/rowSums(.[,2:ncol(.)]),
`No P.C. (%)` = FNPC/rowSums(.[,2:ncol(.)]),
#`ACD/M Dismissal (%)` = `ACD/M Dismissal`/rowSums(.[,2:ncol(.)]),
#`30.30 Speedy (%)` = `30.30 Speedy`/rowSums(.[,2:ncol(.)]),
#`Evidence Dismissal (%)` = `Evidence Dismissal`/rowSums(.[,2:ncol(.)]),
#`Other Non ACD/M Dismissal (%)` = `Other Non ACD/M Dismissal`/rowSums(.[,2:ncol(.)]),
#`Acquitted (%)` = `Acquitted`/rowSums(.[,2:ncol(.)]),
#`Other (%)` = `Other`/rowSums(.[,2:ncol(.)]),
Disposed = rowSums(.[,2:ncol(.)]))  %>%
select(arrest_year,
`Plea Of Guilty`,`Plea (%)`,
`Verdict Guilty`,`Verdict Guilty (%)`,
FNPC, `No P.C. (%)`,
`Verdict-Not Guilty`,`Verdict Not Guilty (%)`,
Disposed) %>%
t() %>%
as.data.frame() %>%
as_tibble() %>%
rownames_to_column(var = " ") %>%
set_names(.[1,-1] %>% unlist() %>% as.numeric() %>% as.character() %>% c(" ",.)) %>%
filter(` `!="ScreenYear") %>%
mutate_at(vars(-1),as.numeric) %>%
mutate(Total = case_when(grepl("%",` `)==T ~
lag(rowSums(.[,2:ncol(.)]))/
rowSums(.[nrow(.),2:ncol(.)]),
TRUE ~
rowSums(.[,2:ncol(.)]))) %>%
mutate_at(vars(-1),funs(ifelse(grepl("%",` `)==T,paste0(round(100*.,1),"%"),comma(.,digits = 0))))
d %>%
filter(disposed.x==1) %>%
group_by(arrest_year,disp) %>%
summarise(Dispositions = n()) %>%
spread(disp,Dispositions,fill = 0) %>%
ungroup() %>%
mutate(`Nolle Pros. (%)` = `Nolle Prosecution`/rowSums(.[,2:ncol(.)]),
`Plea (%)` = `Plea Of Guilty`/rowSums(.[,2:ncol(.)]),
`Verdict Guilty (%)` = `Verdict Guilty`/rowSums(.[,2:ncol(.)]),
`Verdict Not Guilty (%)` = `Verdict-Not Guilty`/rowSums(.[,2:ncol(.)]),
`No P.C. (%)` = FNPC/rowSums(.[,2:ncol(.)]),
#`ACD/M Dismissal (%)` = `ACD/M Dismissal`/rowSums(.[,2:ncol(.)]),
#`30.30 Speedy (%)` = `30.30 Speedy`/rowSums(.[,2:ncol(.)]),
#`Evidence Dismissal (%)` = `Evidence Dismissal`/rowSums(.[,2:ncol(.)]),
#`Other Non ACD/M Dismissal (%)` = `Other Non ACD/M Dismissal`/rowSums(.[,2:ncol(.)]),
#`Acquitted (%)` = `Acquitted`/rowSums(.[,2:ncol(.)]),
#`Other (%)` = `Other`/rowSums(.[,2:ncol(.)]),
Disposed = rowSums(.[,2:ncol(.)]))  %>%
select(arrest_year,
`Plea Of Guilty`,`Plea (%)`,
`Verdict Guilty`,`Verdict Guilty (%)`,
FNPC, `No P.C. (%)`,
`Verdict-Not Guilty`,`Verdict Not Guilty (%)`,
Disposed) %>%
t() %>%
as.data.frame() %>%
#as_tibble() %>%
rownames_to_column(var = " ") %>%
set_names(.[1,-1] %>% unlist() %>% as.numeric() %>% as.character() %>% c(" ",.)) %>%
filter(` `!="ScreenYear") %>%
mutate_at(vars(-1),as.numeric) %>%
mutate(Total = case_when(grepl("%",` `)==T ~
lag(rowSums(.[,2:ncol(.)]))/
rowSums(.[nrow(.),2:ncol(.)]),
TRUE ~
rowSums(.[,2:ncol(.)]))) %>%
mutate_at(vars(-1),funs(ifelse(grepl("%",` `)==T,paste0(round(100*.,1),"%"),comma(.,digits = 0))))
d %>%
filter(disposed.x==1) %>%
group_by(arrest_year,disp) %>%
summarise(Dispositions = n()) %>%
spread(disp,Dispositions,fill = 0) %>%
ungroup() %>%
mutate(`Nolle Pros. (%)` = `Nolle Prosecution`/rowSums(.[,2:ncol(.)]),
`Plea (%)` = `Plea Of Guilty`/rowSums(.[,2:ncol(.)]),
`Verdict Guilty (%)` = `Verdict Guilty`/rowSums(.[,2:ncol(.)]),
`Verdict Not Guilty (%)` = `Verdict-Not Guilty`/rowSums(.[,2:ncol(.)]),
`No P.C. (%)` = FNPC/rowSums(.[,2:ncol(.)]),
Disposed = rowSums(.[,2:ncol(.)]))  %>%
select(arrest_year,
`Plea Of Guilty`,`Plea (%)`,
`Verdict Guilty`,`Verdict Guilty (%)`,
FNPC, `No P.C. (%)`,
`Verdict-Not Guilty`,`Verdict Not Guilty (%)`,
Disposed) %>%
t() %>%
as.data.frame() %>%
#as_tibble() %>%
rownames_to_column(var = " ")
d %>%
filter(disposed.x==1) %>%
group_by(arrest_year,disp) %>%
summarise(Dispositions = n()) %>%
spread(disp,Dispositions,fill = 0) %>%
ungroup() %>%
mutate(`Nolle Pros. (%)` = `Nolle Prosecution`/rowSums(.[,2:ncol(.)]),
`Plea (%)` = `Plea Of Guilty`/rowSums(.[,2:ncol(.)]),
`Verdict Guilty (%)` = `Verdict Guilty`/rowSums(.[,2:ncol(.)]),
`Verdict Not Guilty (%)` = `Verdict-Not Guilty`/rowSums(.[,2:ncol(.)]),
`No P.C. (%)` = FNPC/rowSums(.[,2:ncol(.)]),
Disposed = rowSums(.[,2:ncol(.)]))  %>%
select(arrest_year,
`Plea Of Guilty`,`Plea (%)`,
`Verdict Guilty`,`Verdict Guilty (%)`,
FNPC, `No P.C. (%)`,
`Verdict-Not Guilty`,`Verdict Not Guilty (%)`,
Disposed) %>%
t() %>%
as.data.frame() %>%
#as_tibble() %>%
rownames_to_column(var = " ") %>%
set_names(.[1,-1] %>% unlist() %>% as.numeric() %>% as.character() %>% c(" ",.))
d %>%
filter(disposed.x==1) %>%
group_by(arrest_year,disp) %>%
summarise(Dispositions = n()) %>%
spread(disp,Dispositions,fill = 0) %>%
ungroup() %>%
mutate(`Nolle Pros. (%)` = `Nolle Prosecution`/rowSums(.[,2:ncol(.)]),
`Plea (%)` = `Plea Of Guilty`/rowSums(.[,2:ncol(.)]),
`Verdict Guilty (%)` = `Verdict Guilty`/rowSums(.[,2:ncol(.)]),
`Verdict Not Guilty (%)` = `Verdict-Not Guilty`/rowSums(.[,2:ncol(.)]),
`No P.C. (%)` = FNPC/rowSums(.[,2:ncol(.)]),
Disposed = rowSums(.[,2:ncol(.)]))  %>%
select(arrest_year,
`Plea Of Guilty`,`Plea (%)`,
`Verdict Guilty`,`Verdict Guilty (%)`,
FNPC, `No P.C. (%)`,
`Verdict-Not Guilty`,`Verdict Not Guilty (%)`,
Disposed) %>%
t() %>%
as.data.frame() %>%
#as_tibble() %>%
rownames_to_column(var = " ") %>%
set_names(.[1,-1] %>% unlist() %>% as.numeric() %>% as.character() %>% c(" ",.)) %>%
filter(` `!="arrest_year")
d %>%
filter(disposed.x==1) %>%
group_by(arrest_year,disp) %>%
summarise(Dispositions = n()) %>%
spread(disp,Dispositions,fill = 0) %>%
ungroup() %>%
mutate(`Nolle Pros. (%)` = `Nolle Prosecution`/rowSums(.[,2:ncol(.)]),
`Plea (%)` = `Plea Of Guilty`/rowSums(.[,2:ncol(.)]),
`Verdict Guilty (%)` = `Verdict Guilty`/rowSums(.[,2:ncol(.)]),
`Verdict Not Guilty (%)` = `Verdict-Not Guilty`/rowSums(.[,2:ncol(.)]),
`No P.C. (%)` = FNPC/rowSums(.[,2:ncol(.)]),
Disposed = rowSums(.[,2:ncol(.)]))  %>%
select(arrest_year,
`Plea Of Guilty`,`Plea (%)`,
`Verdict Guilty`,`Verdict Guilty (%)`,
FNPC, `No P.C. (%)`,
`Verdict-Not Guilty`,`Verdict Not Guilty (%)`,
Disposed) %>%
t() %>%
as.data.frame() %>%
#as_tibble() %>%
rownames_to_column(var = " ") %>%
set_names(.[1,-1] %>% unlist() %>% as.numeric() %>% as.character() %>% c(" ",.)) %>%
filter(` `!="arrest_year") %>%
mutate_at(vars(-1),as.numeric) %>%
mutate(Total = case_when(grepl("%",` `)==T ~
lag(rowSums(.[,2:ncol(.)]))/
rowSums(.[nrow(.),2:ncol(.)]),
TRUE ~
rowSums(.[,2:ncol(.)]))) %>%
mutate_at(vars(-1),funs(ifelse(grepl("%",` `)==T,paste0(round(100*.,1),"%"),comma(.,digits = 0))))
kable(dsp,format = "latex",booktabs = T,
align = c("l",rep("c",ncol(dsp))),digits = 0,
format.args = list(big.mark = ","),linesep = "",
caption = "Prostitution Dispositions, 2010 - 2017")
pkgs <- c("shinydashboard", "leaflet", "tidyr", "DT"
"tidyverse", "here", "DescTools", "skimr",
"lubridate", "sjmisc", "tictoc", "purrr",
"xtable", "ggalt", "knitr", "kableExtra", "janitor",
"scales", "Cairo", "dplyr", "feather")
pkgs <- c("shinydashboard", "leaflet", "tidyr", "DT",
"tidyverse", "here", "DescTools", "skimr",
"lubridate", "sjmisc", "tictoc", "purrr",
"xtable", "ggalt", "knitr", "kableExtra", "janitor",
"scales", "Cairo", "dplyr", "feather")
options(scipen=1000)
lapply(pkgs, require, character.only = T)
pkgs <- c("shinydashboard", "tidyr", "DT",
"tidyverse", "here", "DescTools", "skimr",
"lubridate", "sjmisc", "tictoc", "purrr",
"xtable", "ggalt", "knitr", "kableExtra", "janitor",
"scales", "Cairo", "dplyr", "feather")
options(scipen=1000)
lapply(pkgs, require, character.only = T)
shiny::runApp('~/CookCo/Output/Dashboard')
runApp('~/CookCo/Output/Dashboard')
